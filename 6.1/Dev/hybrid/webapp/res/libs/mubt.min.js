!function(a,b,c){if(!a.JSON||!a.JSON.parse||!a.JSON.stringify||"undefined"==typeof localStorage)return 0;if(!a.$_bf||!0!==a.$_bf.loaded)try{var d=b.documentElement,e=function(){},f={undefined:"undefined",number:"number","boolean":"boolean",string:"string","[object Function]":"function","[object RegExp]":"regexp","[object Array]":"array","[object Date]":"date","[object Error]":"error","[object Object]":"object"},g=1,h=f.toString,i=/\$\{(\w+)\}/g,j=/((test[a-z]?|dev|uat|ui|local)\.sh\.(ctrip|huixuan)travel)|(qa\.nt\.ctripcorp)/i,k="",l="",m="",n="",o="",p="",q=2,r=!1;a.$_bf=a.$_bf||{},a.$_bf.version="1.1.0",a.$_bf.loaded=!0;var s=function(){var d=navigator,e=screen.colorDepth+"-bit";p=(d.language||d.browserLanguage||"").toLowerCase();var g={version:"1.1.0",readyMax:30,isReady:!1,enter:(new Date).getTime(),watchdog:function(){},now:Date.now||function(){return(new Date).getTime()},toint:function(a){return parseInt(a,10)||0},plus:function(a){return g.toint(a)+1},type:function(a){return f[typeof a]||f[h.call(a)]||(a?"object":"null")},isArray:function(a){return"array"==g.type(a)},isFunction:function(a){return"function"==g.type(a)},isEmpty:function(a){return a===c||"-"==a||""==a},getRand:function(){return(""+Math.random()).slice(-8)},hash:function(a){var b,c=1,d=0;if(!g.isEmpty(a)){for(c=0,b=a.length-1;b>=0;b--)d=a.charCodeAt(b),c=(c<<6&268435455)+d+(d<<14),d=266338304&c,c=0!=d?c^d>>21:c;return c}},getHash:function(){var a=[d.appName,d.appVersion,d.platform,d.userAgent,screen.width+screen.height,e,b.cookie?b.cookie:"",l].join("");return g.hash(a)},$:function(a){return"string"!=typeof a?!1:b.getElementById(a)},$v:function(a){return(a=g.$(a))&&a.value||""},send:function(a,b){if("string"!=typeof a)return!1;var c=m+"/bf.gif?",d=new Image;return d.onload=function(){d=d.onload=d.onerror=null,b&&g.isFunction(b)&&b(1)},d.onerror=function(){d=d.onload=d.onerror=null,b&&g.isFunction(b)&&b(0)},d.src=c+a+"&rd="+s.now()+"&jv=1.1.0",!0},decode:function(a){return decodeURIComponent(a)},encode:function(a){return encodeURIComponent(a)},getCookie:function(a,c,d){return(a=b.cookie.match(RegExp("(^| )"+a+"=([^;]*)(;|$)")))?d?g.decode(a[2]):a[2]:c||""},getCookieObj:function(a,b){var c,d={__k:a},e=[];if(e=g.getCookie(a,"",b))for(var e=e.split("&")||[],f=0;f<e.length;f++)c=e[f].split("="),1<c.length&&(d[c[0]]=c[1]);return d},setCookie:function(a,c,d){var e=k?";domain="+k:"",f="";d>=0&&(f=";expires="+new Date(g.now()+d).toUTCString()),b.cookie=a+"="+g.encode(c)+e+";path=/"+f},getItem:function(a,b){var c=localStorage.getItem(a)||"";if(c&&b)try{c=JSON.parse(c)}catch(d){c=""}return c},setItem:function(a,b){"object"==typeof b&&(b=JSON.stringify(b)),"string"==typeof b&&localStorage.setItem(a,b)},extend:function(){var a,b,d,e=arguments[0]||{},f=1,g=arguments.length;for(g===f&&(e=this,--f);g>f;f++)if(null!=(d=arguments[f]))for(b in d)a=d[b],e!==a&&a!==c&&(e[b]=a);return e},uniqueID:function(){return g.getRand()^2147483647&g.getHash()},grab:function(a,b){var c,d={};switch(b=b||{},d.v=b.v||"",d.w=b.w||"default",d.l=b.l||0,d.t=b.t||"string",d.w){case"input":c=g.$v(a);break;case"cookie":c=g.getCookie(a,d.v);break;case"function":c=g.isFunction(d.v)?d.v():"";break;default:c=d.v}switch(d.t){case"number":return g.toint(c);case"boolean":return!!c;default:return d.l?String(c).substring(0,d.l):c}},getTagIndex:function(a){var b=0;if(a.parentNode)for(var c=a.parentNode.firstChild;c&&c!=a;)1==c.nodeType&&c.tagName==a.tagName&&b++,c=c.nextSibling;return b>0?"["+ ++b+"]":""},getXpath:function(a){for(var b,c=[],d=0;a&&9!=a.nodeType;){var e=a.nodeName+g.getTagIndex(a)+(a.id?"[@id='"+a.id+"']":"");(b=a.getAttribute("block"))&&(e+="[@block='"+b+"']"),c[d++]=e,a=a.parentNode}return c.reverse().join("/")},initDomin:function(a){if(a=a||location.hostname,/^(\d|\.)+$/.test(a))return a;var b="",c=a.split(".").reverse(),b=c[1]+"."+c[0];return/com\.\w{2,}$/i.test(a)&&(b=c[2]+"."+b),b},initEnv:function(a){var b="file:"==o?"http:":o;m=!0===r?"http://localhost":"dev"==a?b+"//10.3.6.192:8086":"test"==a?b+"//ubt.uat.qa.nt.ctripcorp.com":"offline"==a?b+"//ubt.sh.ctriptravel.com":"uat"==a||j.test(n)?b+"//ubt.uat.qa.nt.ctripcorp.com":b+"//s.c-ctrip.com"},init:function(){var c=a.location||b.location,d=c.hostname;o=c.protocol,k=g.initDomin(d),n=c.href,g.initEnv("string"==typeof a.$_bf.env?a.$_bf.env:"online"),c="";try{c=b&&b.referrer}catch(e){}if(""==c&&a.opener)try{c=a.opener.location.href}catch(f){}l=c}};return g.init(),g}();!function(a){function b(a){var b=0,c=[],d=0;this.n=function(){if(0==d){if(b>=a.length)return null;var e=a.charCodeAt(b++);if(127>=e)return e;if(2047>=e)return c[1]=128|63&e,d=1,192|e>>6&31;if(e>=55296&&57343>=e)throw"unsupported char code.";return c[0]=128|e>>6&63,c[1]=128|63&e,d=2,224|e>>12&15}return c[c.length-d--]}}function c(a){var b=new function(a){for(var b,c=[],d=-1;null!=(b=a.n());)if(0==b[0])(-1==d||255==c[d])&&(c.push(128),d=c.length-1),c.push(b[1]),c[d]++;else{d=-1,c.push(b[0]);var e=b[1];if(127>=e)c.push(e);else{for(b=[];e>0;)b.push(127&e),e>>=7;for(e=b.length-1;e>=0;e--)c.push(128|b[e]);c[c.length-1]&=127}}d=0,this.n=function(){return d>=c.length?null:c[d++]}}(new function(a){function b(a,b){for(var c=0,d=0;g>d;d++)c=131*c+a[b+d];return c}for(var c,d,h,i=[],j=[],k=[],l=0;null!=(c=a.n());)k.push(c);this.n=function(){if(l<k.length-g+1){for(var a=b(k,l),c=h=d=0;c<j.length;c++)if(a==j[c]){var m,n;for(m=c,n=l;m<i.length&&n<k.length&&!(i[m]!=k[n]||n-l>=f);m++,n++);m-c>=h&&m-c>=g&&(h=m-c,d=c)}return 0==h?(a=[0,k[l]],c=k[l++],i.push(c),i.length>e&&(i.shift(),j.shift()),i.length>=g&&(c=i.length-g,j[c]=b(i,c)),a):(l+=h,[h,i.length-(d+h)])}return l<k.length?[0,k[l++]]:void 0}}(a));this.n=function(){return b.n()}}function d(a){var b=[],c=0;this.n=function(){if(c>0)return b[4-c--];var d=[a.n(),a.n(),a.n()];return null==d[0]?null:(b[0]=h.charAt(d[0]>>2),b[1]=h.charAt(null==d[1]?d[0]<<4&63:63&(d[0]<<4|d[1]>>4)),b[2]=null==d[1]?"~":h.charAt(null==d[2]?d[1]<<2&63:63&(d[1]<<2|d[2]>>6)),b[3]=null==d[2]?"~":h.charAt(63&d[2]),c=3,b[0])}}var e=1024,f=63,g=3,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";a.compress=function(a){a=new b(a),a=new c(a),a=new d(a);for(var e,f=[];null!=(e=a.n());)f[f.length]=e;return f.join("")}}(s);var t=function(a,b){function c(){d.queueCheck(!0,"useraction"),d.queueCheck(!0,"matrix"),d.status.destroyed&&d.status.pv||setTimeout(c,5e3)}this.status={destroyed:!1,isnewvid:0,islogin:0,pvready:!1,pv:!1,ps:!1},this.data={orderid:"",abtest:"",pid:0,vid:"",sid:0,pvid:0,tid:"",ppv:0,ppi:0},this.queue={},this.init(a,b),this.initUBT();var d=this;c()};t.prototype={constructor:t,init:function(a,b){"object"==typeof a&&("undefined"!=typeof a.page_id&&(this.data.pid=s.toint(a.page_id)),"string"==typeof a.url&&(n=a.url),("string"==typeof a.orderid||"number"==typeof a.orderid)&&(this.data.orderid=a.orderid),"string"==typeof a.refer&&(l=a.refer),a.tid&&(this.data.tid=(""+a.tid).substring(0,30))),this.pvcallback=s.isFunction(b)?b:e},initUBT:function(){var a,b=0,c=0,d=0,d=0,e=s.getItem("CTRIP_UBT_M",!0);e&&e.vid&&e.create?(a=e.vid,b=e.sid,c=s.plus(e.pvid),d=e.sid_ts,18e5<s.now()-d?(b=s.plus(b),this.data.ppi=0,this.data.ppv=0):(this.data.ppi=e.pid||0,this.data.ppv=e.pvid||0),d=e.create):((c=this.readOldBfa())&&6<c.length?(a=c[1]+"."+c[2],b=s.plus(c[6]),c=s.plus(c[7])):(this.status.isnewvid=1,a=s.enter+"."+s.uniqueID().toString(36),c=b=1),d=s.enter),this.data.vid=a,this.data.sid=b,this.data.pvid=c,this.data.ubt={pid:this.getPid(),vid:a,sid:b,pvid:c,sid_ts:s.now(),create:d},this.updateUBT()},updateUBT:function(a){"number"==typeof a&&(this.data.ubt.pid=a),s.setItem("CTRIP_UBT_M",this.data.ubt)},readOldBfa:function(){var a=s.getCookie("_bfa","",!0);if(a||(a=s.getItem("_bfa")),a&&(a=a.split("."),6<a.length)){try{localStorage.removeItem("_bfa"),localStorage.removeItem("_bfs"),localStorage.removeItem("_bfi")}catch(b){}return a}return!1},getPid:function(){return this.data.pid||(this.data.pid=s.toint(s.$v("page_id"))),this.data.pid},getABtest:function(){for(var a=s.$("ab_testing_tracker"),c=[],d="";a;)d+=a.value,c.push(a),a.removeAttribute("id"),a.removeAttribute("name"),a=s.$("ab_testing_tracker");for(a=0;a<c.length;a++)c[a].setAttribute("id","ab_testing_tracker");return c="",(c=b.location.hash)&&-1!==c.indexOf("abtest=")&&(d+=decodeURIComponent(c.replace(/.*(abtest=)/i,"").replace(/#.*/i,""))),d.substring(0,280)},get:function(a){if("string"!=typeof a)return"";switch(a){case"vid":case"sid":case"pvid":return this.data[a];case"islogin":case"isnewvid":return this.status[a];case"fullpv":return this.data.vid+"."+this.data.sid+"."+this.data.pvid}},getCommon:function(a){return a=[],a[0]=this.getPid(),a[1]=this.data.vid,a[2]=this.data.sid,a[3]=this.data.pvid,a[4]=this.data.tid,a[5]=this.getABtest(),a[6]="",a},getUinfo:function(){var a=this.getDatum(),b=[10];return b[1]=this.data.ppi,b[2]=this.data.ppv,b[3]=n,b[4]=screen.width,b[5]=screen.height,b[6]="",b[7]=p,b[8]=a.engine,b[9]=a.keyword,b[10]=l,b[11]=this.getABtest(),b[12]=this.status.isnewvid,b[13]=this.status.islogin,b[14]=a.user_id,b[15]=a.user_grade,b[16]=a.corpid,b[17]=a.start_city,b[18]=a.alliance_id,b[19]=a.alliance_sid,b[20]=a.alliance_ouid,b[21]=this.data.orderid,b[22]=a.duid,b[23]=a.zdata,b[24]=a.callid,b[25]=a.bid,b[26]=s.getItem("GUID"),b[27]=s.getItem("SOURCEID"),b[28]=a.appinfo,b},getDatum:function(){if(this.data.business)return this.data.business;var a=s.getCookieObj("Session"),b=s.getCookieObj("CtripUserInfo"),c=s.getCookieObj("StartCity_Pkg"),d=s.getCookieObj("Union"),a={engine:a&&a.SmartLinkCode||"",keyword:a&&a.SmartLinkQuary||"",start_city:c&&c.PkgStartCity||"",alliance_id:d&&d.AllianceID?d.AllianceID:"",alliance_sid:d&&d.SID?d.SID:"",alliance_ouid:d&&d.OUID?d.OUID:"",user_id:s.getCookie("login_uid",""),user_grade:b&&b.VipGrade||"",corpid:s.getCookie("corpid",""),duid:b&&b.U||"",zdata:s.getCookie("zdatactrip",""),callid:s.$v("bf_ubt_tl_callid")||"",bid:""};try{if(!a.alliance_id){var e=s.getItem("UNION",!0);e&&e.data&&(e.st||e.timeout)&&(b=0,(b=new Date(e.st?e.st:e.timeout.replace(/-/g,"/")))&&b>=e.enter&&(a.alliance_id=d.AllianceID||d.ALLIANCEID||"",a.alliance_sid=d.SID||"",a.alliance_ouid=d.OUID||""))}}catch(f){}if(!a.user_id&&!a.duid)try{var g=s.getItem("USER",!0);if(g&&g.value){var h=g.value;a.user_id=h.LoginName||h.UserID||"",a.user_grade=h.VipGrade||""}}catch(i){}return(a.duid||a.user_id&&a.user_grade)&&(this.status.islogin=1),this.data.orderid||(this.data.orderid=s.$v("bf_ubt_orderid")),this.data.tid||(this.data.tid=s.$v("CorrelationId")),d=s.getItem("APPINFO",!0),a.appinfo="object"==typeof d?'{"version":'+(d.version||"")+',"platform":'+(d.platform||"")+"}":"",this.data.business=a},sendPV:function(){if(this.status.pvready)return!1;try{this.getDatum();var a={c:this.getCommon(!0),d:{uinfo:this.getUinfo()}},b="ac=g&d="+s.encode(JSON.stringify(a)),c=this;s.send(b,function(a){if(a){if(c.status.pv=!0,c.sendPS(),c.pvcallback(a),a=c.queue["default"])for(var b=0;b<a.length;b++){var d=a[b],e=c.dataHandler(d);e&&s.send(e,d.callback)}}else 0<--q&&c.sendPV()}),this.updateUBT(this.getPid()),this.status.pvready=!0}catch(d){}},getPS:function(){for(var b="navigationStart redirectStart unloadEventStart unloadEventEnd redirectEnd fetchStart domainLookupStart domainLookupEnd connectStart connectEnd requestStart responseStart responseEnd domLoading domInteractive domContentLoadedEventStart domContentLoadedEventEnd domComplete loadEventStart loadEventEnd".split(" "),c=a.performance.timing,d=[6],e=0;e<b.length;e++)d.push(c[b[e]]);return d.push(a.performance.navigation.type||0),d.push(a.performance.navigation.redirectCount||0),d},sendPS:function(){function b(){if(a.performance.timing.loadEventEnd){var e={c:d.getCommon(),d:{ps:d.getPS()}},e="ac=g&d="+s.encode(JSON.stringify(e));return s.send(e),d.status.ps=!0}300>c&&(c++,setTimeout(b,1e3))}if(a.performance&&!this.status.ps){var c=0,d=this;try{b()}catch(e){}}},replaceParam:function(a){var b={duid:this.getDatum().duid,page_id:this.getPid(),is_login:this.status.islogin};return a.replace(i,function(a,c){return c in b?b[c]:a})},dataHandler:function(a){if("string"==typeof a)return a;if("object"==typeof a){if(a.c&&a.d)return a={c:this.getCommon(),d:a.d},"ac=g&d="+s.encode(JSON.stringify(a));if(a.k&&a.v){var b=s.encode(this.replaceParam(a.v));return"ac=tl&pi="+this.getPid()+"&key="+a.k+"&val="+b+"&pv="+this.get("fullpv")+"&v=6"}}},sendData:function(a){if(this.status.pv){var b=this.dataHandler(a);b&&s.send(b,a.callback)}else this.queuePush("default",a)},queuePush:function(a,b){this.queue[a]||(this.queue[a]=[]),this.queue[a].push(b),this.queueCheck(!1,a)},queueCheck:function(a,b){if(!this.status.pv||"default"==b)return!1;var c=this.queue[b];if(c){var d=c.length;(d>5||a&&d>0)&&(c=c.splice(0,5),c=[[1,b],this.getCommon(),c],this.queueSend(c))}},queueSend:function(a){var b="";try{b=s.compress(JSON.stringify(a))}catch(c){}b&&s.send("ac=a&d="+b)},destroy:function(){this.queueCheck(!0,"useraction"),this.queueCheck(!0,"matrix"),this.status.destroyed=!0},ready:function(){s.isReady&&this.sendPV()}};var u=new t;!function(){var b=!1,c={_setDebug:function(a){a&&(r=!0,m="http://localhost")},_setEnv:function(a){"string"==typeof a&&s.initEnv(a)},_getFullPV:function(a){var b=u.get("fullpv");return a&&s.isFunction(a)&&a(b),b},_unload:function(){("undefined"!=typeof $&&$.bindFastClick||"object"==typeof Lizard)&&1==g?g=0:(u.status.pvready||u.sendPV(),u.destroy(),u=new t)},_asynRefresh:function(a,b){u.status.pvready?(u.destroy(),u=new t(a||{},b)):u.init(a,b),u.sendPV()},_tracklog:function(a,b,c){return b&&"string"==typeof b&&"string"==typeof a?void u.sendData({k:a,v:b,callback:c}):(s.isFunction(c)&&c(0),!1)},_trackError:function(a,c){if("object"!=typeof a)return!1;if(b)return b=!1;!0===a.skip&&(b=!0);for(var d="version message line file category framework time repeat islogin name column".split(" "),e=[7,"",0,"","","",s.now()-s.enter,1,u.get("islogin"),"",0],f=1,g=d.length;g>f;f++){var h=d[f];if(a[h]){var i=a[h]+"";switch(h){case"message":case"file":i=i.substring(0,500);break;case"category":case"framework":case"name":i=i.substring(0,100);break;case"time":i=parseInt(i,10);break;case"column":i=parseInt(i,10);break;default:i=parseInt(i,10)||0}e[f]=i}}e.push("trace"),u.sendData({c:!0,d:{error:e},callback:c})},_trackUserBlock:function(a,b){if("object"!=typeof a)return!1;var c=[6];c[1]=u.get("islogin"),c[2]=String(a.message||"").substring(0,300),c[3]=String(a.value||"").substring(0,300),c[4]=String(a.type||"").substring(0,50),c[5]=String(a.dom||"").substring(0,100),c[6]=String(a.form||"").substring(0,100),c[7]=s.toint(a.count||0,10),u.sendData({c:!0,d:{ub:c},callback:b})},_trackMatrix:function(a,b,c,d,e){d="number"==typeof d?d:s.now();var f=0;"string"==typeof a&&"object"==typeof b&&"number"==typeof c&&(u.queuePush("matrix",{name:a,tags:b,value:c,ts:d}),f=1),s.isFunction(e)&&e(f)},push:function(a){var b;return s.isArray&&(b=a[0],"_"==b[0]&&s.isFunction(c[b]))?c[b].apply(c,a.slice(1)):!1}};if(s.isArray(a.__bfi)){var d=a.__bfi,e=d.length;if(e>0)for(var f=0;e>f;f++)c.push(d[f])}else a.__bfi=[];a.__bfi.push=c.push,s.extend(a.$_bf,{_getFullPV:c._getFullPV,tracklog:c._tracklog,trackError:c._trackError,asynRefresh:c._asynRefresh})}();var v=function(){var a=s.$v("page_id");return"wait"!=a&&(a=s.toint(a),0!=a?s.isReady=!0:"complete"==b.readyState?s.isReady=!0:0>=s.readyMax&&(s.isReady=!0)),!s.isReady&&0<s.readyMax?(s.readyMax--,void setTimeout(v,500)):u.ready()};if(v(),b.addEventListener("click",function(a){var c=a.target||a.srcElement,e=c.nodeName.toUpperCase();if(c.getBoundingClientRect){var f=c.getBoundingClientRect(),g="",h=Math.max(d.scrollLeft,b.body.scrollLeft),i=Math.max(d.scrollTop,b.body.scrollTop),j=a.pageX||a.clientX+h;a=a.pageY||a.clientY+i;var k=parseInt((d.clientWidth||b.body.clientWidth)/2,10);"SELECT"==e&&0>a-f.top-i?(g+="[@x='"+parseInt(j+f.left+h-k,10)+"'][@y='"+parseInt(a+f.top,10)+"']",g=g+("[@rx='"+j+"']")+("[@ry='"+(a-i)+"']")):(g+="[@x='"+(j-k)+"'][@y='"+a+"']",g+="[@rx='"+parseInt(j-f.left-h,10)+"']",g+="[@ry='"+parseInt(a-f.top-i,10)+"']"),u.queuePush("useraction",{action:"click",xpath:s.getXpath(c)+g,ts:s.now()})}}),null===a.onerror){var w={};a.onerror=function(){try{var a=arguments,b={message:""+a[0],file:""+a[1],category:"inner-error",framework:"normal",time:s.now()-s.enter,line:a[2],column:a[3],repeat:1},c="err_"+s.hash(b.message+b.file+b.line);w[c]||(__bfi.push(["_trackError",b]),w[c]=!0)}catch(d){}}}}catch(x){}}(window,document);