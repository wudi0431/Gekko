window.replace=function(){return""},function(a,b){function c(){var a=u.$v("page_id");"wait"!=a&&(a=v.toint(a),0!=a?v.ready():"complete"==e.readyState?v.ready():0>=u.readyMax&&v.ready()),u.isReady||v.isPVSend||(u.readyMax--,setTimeout(c,1e3))}function d(a){var b;return u.isArray(a)&&(b=a[0],"_"==b[0]&&u.isFunction(v[b]))?(v[b].apply(v,a.slice(1)),!0):!1}if(!a.JSON||!a.JSON.parse||!a.JSON.stringify||a.$_bf&&!0===a.$_bf.loaded)return 0;var e=a.document,f=a.screen,g=a.location,h={undefined:"undefined",number:"number","boolean":"boolean",string:"string","[object Function]":"function","[object RegExp]":"regexp","[object Array]":"array","[object Date]":"date","[object Error]":"error","[object Object]":"object"},i=function(){},j=h.toString,k=/\$\{(\w+)\}/g,l=/((test[a-z]?|dev|uat|ui|local)\.sh\.(ctrip|huixuan)travel)|(qa\.nt\.ctripcorp)/i,m="",n="",o="",p=g.href,q="",r="online",s=g.protocol;a.$_bf=a.$_bf||{},a.$_bf.version="1.0.0",a.$_bf.loaded=!0;var t=function(){var b=a.navigator,c=f.colorDepth+"-bit",d=(b.language?b.language:b.browserLanguage?b.browserLanguage:"").toLowerCase(),g="";try{g=e&&e.referrer}catch(h){}if(""==g)try{a.opener&&(g=a.opener.location&&a.opener.location.href)}catch(i){}return{color:c,lang:d,java:0,ref:g,getHash:function(){for(var h=a.history.length||0,i=[b.appName,b.appVersion,d,b.platform,b.userAgent,f.width+f.height,c,e.cookie?e.cookie:"",g].join(""),j=i.length;h>0;)i+=h--^j++;return u.hash(i)}}}(),u=function(){this.enterTime=u.now(),this.isPSSend=this.isPVSend=!1,this.initCFG(),this.isNewVid=this.isLogin=this.pid=0,this.init()};u.fn=u.prototype={constructor:u,version:"1.0.0",_QUEUE:[],initCFG:function(){m=g.hostname.split(".").slice(-2).join(".")||".ctrip.com",this._setEnv(a.$_bf.env||r),n=t.ref},init:function(){this._bfi=this._bfs=this._bfa="",this.readBfa(),this.readBfi()},toint:function(a){return parseInt(a,10)||0},plus:function(a){return parseInt(a,10)+1},uniqueID:function(){return(u.getRand()^2147483647&t.getHash()).toString(36)},readBfa:function(){var a=this.getItem("_bfa");a&&(a=a.split("."),6<a.length&&(this._bfa=a,this.isNewVid=0)),this._bfa||(a=this.enterTime,this._bfa=[1,a,this.uniqueID(),1,a,a,0,0],this.isNewVid=1),this.sessRead()},sessRead:function(){var a=this.getItem("_bfs");a&&!this.isNewVid?(this._bfs=a.split("."),this._bfs[1]=this.plus(this._bfs[1])):(this._bfs=[1,1],this._bfa[4]=this._bfa[5],this._bfa[5]=this.enterTime,this._bfa[6]=this.plus(this._bfa[6])),this._bfa[7]=this.plus(this._bfa[7]),this.setItem("_bfa",this._bfa.join("."),63072e6),this.setItem("_bfs",this._bfs.join("."),18e5)},readBfi:function(){var a=this.getItem("_bfi");return a&&(a=a.split("."),4==a.length)?(this._bfi=a,this.ppi=a[1],void(this.ppv=a[3])):void(this.ppv=this.ppi=0)},writeBfi:function(){var a=[this.ppi,this.getPid(),this.ppv,this.get("pvid")].join(".");this.setItem("_bfi",a)},get:function(a){if(this._bfa){var b=this._bfa;switch(a){case"vid":return b[1]+"."+b[2];case"sid":return this.toint(b[6]);case"pvid":return this.toint(b[7]);case"fullpv":return b[1]+"."+b[2]+"."+b[6]+"."+b[7];default:return""}}},set:function(a,b){switch(a){case"domain":this._setDomain(b);break;case"clickv1":this._setClickV1(b);break;case"collect":this._delCollect(b);break;case"referrer":this._setReferrer(b);break;case"orderid":this._setOrderID(b)}},getPid:function(){return this.pid||(this.pid=this.toint(u.$v("page_id"))),this.pid},getItem:function(a){return"file:"==s?u.getItem(a)||"":u.getCookie(a,!0)},setItem:function(a,b,c){"file:"==s?u.setItem(a,b):u.setCookie(a,b,c)},getABtest:function(){if("undefined"!=typeof this.d_abtest)return this.d_abtest;for(var a=u.$("ab_testing_tracker"),b=[],c="";a;)c+=a.value||"",b.push(a),a.removeAttribute("id"),a.removeAttribute("name"),a=u.$("ab_testing_tracker");for(a=0;a<b.length;a++)b[a].setAttribute("id","ab_testing_tracker");return(b=g.hash||"")&&-1!==b.indexOf("abtest=")&&(c+=decodeURIComponent(b.replace(/.*(abtest=)/i,"").replace(/#.*/i,""))),this.d_abtest=c},getCommon:function(a){return(!this.d_common||a)&&(this.d_common=[this.getPid(),this.get("vid"),this.get("sid"),this.get("pvid"),u.$v("CorrelationId"),this.getABtest(),u.$v("bf_ubt_offline_mid")]),this.d_common},getPVParams:function(){if(this.d_params)return this.d_params;var a=u.getCookieObj("Session"),b=u.getCookieObj("CtripUserInfo"),c=u.getCookieObj("StartCity_Pkg"),d=u.getCookieObj("Union"),e=u.$v("bf_ubt_orderid");return e&&(q=e),a={engine:a&&a.SmartLinkCode?a.SmartLinkCode:"",keyword:a&&a.SmartLinkQuary?a.SmartLinkQuary:"",start_city:c&&c.PkgStartCity?c.PkgStartCity:"",alliance_id:d&&d.AllianceID?d.AllianceID:"",alliance_sid:d&&d.SID?d.SID:"",alliance_ouid:d&&d.OUID?d.OUID:"",user_grade:b&&b.VipGrade?b.VipGrade:"",duid:b&&b.U?b.U:"",zdata:u.getCookie("zdatactrip"),callid:u.$v("bf_ubt_tl_callid")},a.duid&&(this.isLogin=1),this.d_params=a},getUinfo:function(){var a=this.getPVParams(),b=[9];return b[1]=this.ppi,b[2]=this.ppv,b[3]=String(p).substring(0,600),b[4]=f.width,b[5]=f.height,b[6]="",b[7]=t.lang,b[8]=a.engine,b[9]=a.keyword,b[10]=n,b[11]=this.getABtest(),b[12]=this.isNewVid,b[13]=this.isLogin,b[14]=u.getCookie("login_uid"),b[15]=a.user_grade,b[16]=u.getCookie("corpid"),b[17]=a.start_city,b[18]=a.alliance_id,b[19]=a.alliance_sid,b[20]=a.alliance_ouid,b[21]=q||"",b[22]=a.duid,b[23]=a.zdata,b[24]=a.callid,b[25]=u.getCookie("bid"),b[26]=u.getItem("GUID"),b[27]=u.getItem("SOURCEID"),b},sendPV:function(a){var b=this;if(this.isPVSend)return!0;try{var c={c:this.getCommon(!0),d:{uinfo:this.getUinfo()}},d="ac=g&d="+encodeURIComponent(JSON.stringify(c));u.send(d,function(c){c&&(b.isPVSend=!0,b.queueSend_()),u.isFunction(a)&&a(c)})}catch(e){}},replaceParam:function(a){var b={duid:this.getPVParams().duid,page_id:this.getPid(),is_login:this.isLogin};return a.replace(k,function(a,c){return c in b?b[c]:a})},dataHandle:function(a){if("string"==typeof a)return a;if("object"==typeof a){if(a.c&&a.d)return a={c:this.getCommon(),d:a.d},"ac=g&d="+encodeURIComponent(JSON.stringify(a));if(a.k&&a.v){var b=encodeURIComponent(this.replaceParam(a.v));return"ac=tl&pi="+this.getPid()+"&key="+a.k+"&val="+b+"&pv="+this.get("fullpv")+"&v=6"}}return!1},sendData:function(a){if(this.isPVSend){var b=this.dataHandle(a);b&&u.send(b,a.callback||i)}else this._QUEUE.push(a)},queueSend_:function(){var a=this._QUEUE,b=a.length;if(b>0){for(var c=0;b>c;c++){var d=a[c],e=this.dataHandle(d);e&&u.send(e,d.callback||i)}this._QUEUE=[]}},getPS:function(){for(var b="navigationStart redirectStart unloadEventStart unloadEventEnd redirectEnd fetchStart domainLookupStart domainLookupEnd connectStart connectEnd requestStart responseStart responseEnd domLoading domInteractive domContentLoadedEventStart domContentLoadedEventEnd domComplete loadEventStart loadEventEnd".split(" "),c=a.performance.timing,d=[6],e=0;e<b.length;e++)d.push(c[b[e]]);return d.push(a.performance.navigation.type||0),d.push(a.performance.navigation.redirectCount||0),d},sendPS:function(){function b(){if(a.performance.timing.loadEventEnd&&!d.isPSSend){var e={c:d.getCommon(),d:{ps:d.getPS()}},e="ac=g&d="+encodeURIComponent(JSON.stringify(e));u.send(e),d.isPSSend=!0}else 300>c&&(c++,setTimeout(b,1e3))}if(a.performance&&!(0>=this.pid)){var c=0,d=this;b()}},ready:function(){u.isReady=!0,this.sendPV(),this.writeBfi(),this.sendPS()}},u.extend=u.fn.extend=function(){var a,c,d,e=arguments[0]||{},f=1,g=arguments.length;for(g===f&&(e=this,--f);g>f;f++)if(null!=(d=arguments[f]))for(c in d)a=d[c],e!==a&&a!==b&&(e[c]=a);return e},u.extend({isReady:!1,readyMax:10,now:Date.now||function(){return(new Date).getTime()},isFunction:function(a){return"function"===u.type(a)},isArray:function(a){return"array"===u.type(a)},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return h[typeof a]||h[j.call(a)]||(a?"object":"null")},isEmpty:function(a){return a===b||"-"==a||""==a},contains:function(a,b){return-1<a.indexOf(b)},getRand:function(){return Math.round(2147483647*Math.random())},hash:function(a){var b,c=1,d=0;if(!u.isEmpty(a))for(c=0,b=a.length-1;b>=0;b--)d=a.charCodeAt(b),c=(c<<6&268435455)+d+(d<<14),d=266338304&c,c=0!=d?c^d>>21:c;return c},each:function(a,b,c){var d=0;if(c){for(d in a)if(b.apply(a[d],c),!1===value)break}else for(d in a)if(value=b.call(a[d],d,a[d]),!1===value)break;return a},setCookie:function(a,b,c){var d=m?";domain="+m:"",f="";c>=0&&(f=";expires="+new Date(u.now()+c).toUTCString()),e.cookie=a+"="+encodeURIComponent(b)+d+";path=/"+f},getCookie:function(a,b){var c=e.cookie.match(RegExp("(^| )"+a+"=([^;]*)(;|$)"));return c?b?decodeURIComponent(c[2]):c[2]:""},getCookieObj:function(a,b){var c,d={__k:a},e=[];if(e=u.getCookie(a,b))for(var e=e.split("&"),f=0;f<e.length;f++)c=e[f].split("="),1<c.length&&(d[c[0]]=c[1]);return d},getItem:function(a){return"undefined"!=typeof localStorage?localStorage.getItem(a)||"":""},setItem:function(a,b){"undefined"!=typeof localStorage&&localStorage.setItem(a,b)},$:function(a){return"string"!=typeof a?!1:e.getElementById(a)},$v:function(a){return(a=u.$(a))&&a.value||""},send:function(a,b){var c=o+"bf.gif",c=c+("?"+a+"&rd="+(u.getRand()&u.now())+"&jv=1.0.0"),d=new Image;d.onload=function(){d=d.onload=null,u.isFunction(b)&&b(1)},d.src=c}}),u.on=function(){return e.addEventListener?function(a,b,c){a.addEventListener(b,c,flug)}:e.attachEvent?function(a,b,c){a.attachEvent("on"+b,c)}:void 0}(),u.fn.extend({_setDebug:function(){},_setEnv:function(a){var b="file:"==s?"http:":s;"test"==a||l.test(p)?(a="test",o=b+"//ubt.test.sh.ctriptravel.com/"):"offline"==a?o=b+"//ubt.sh.ctriptravel.com/":"online"==a&&(o=b+"//s.c-ctrip.com/"),r=a},_setDomain:function(a){m=a},_setClickV1:function(){},_setReferrer:function(a){n=a},_setOrderID:function(a){a&&(q=a)},_delCollect:function(){},_asynRefresh:function(a){"object"==typeof a&&(a.page_id&&(this.pid=this.toint(a.page_id)),a.url&&u.contains(a.url,"http:")&&(p=a.url),a.orderid&&(q=a.orderid)),this.isPVSend&&this.init(),this.isPVSend=!1,this.sendPV(),this.writeBfi()},_tracklog:function(a,b,c){return"string"!=typeof b?!1:void this.sendData({k:a,v:b,callback:c||!1})},_trackError:function(){},_trackUserBlock:function(){},_getFullPV:function(a){var b=this._bfa;return a&&u.isFunction(a)&&a(b),b}});var v=new u;if(a.$_bf._getFullPV=function(){return v.get("fullpv")},a.$_bf.tracklog=function(a,b,c){v._tracklog(a,b,c)},a.$_bf.trackError=function(a,b){v._trackError(a,b)},a.$_bf.asynRefresh=function(a,b){v._asynRefresh(a,b)},c(),"array"==u.type(a.__bfi))for(var w=a.__bfi.length,x=0;w>x;x++)d(a.__bfi[x]);else a.__bfi=[];a.__bfi.push=d}(window);