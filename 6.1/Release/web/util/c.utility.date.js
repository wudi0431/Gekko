define(["cCoreInherit","cUtilityServertime"],function(a,b){var c={};return c.Date=new a.Class({initialize:function(a){a=a||new Date,this.date=new Date(a)},addDay:function(a){return a=a||0,this.date.setDate(this.date.getDate()+a),this},addMonth:function(a){return a=a||0,this.date.setMonth(this.date.getMonth()+a),this},addHours:function(a){return a=a||0,this.date.setHours(this.date.getHours()+a),this},addMinutes:function(a){return a=a||0,this.date.setMinutes(this.date.getMinutes()+a),this},addSeconds:function(a){return a=a||0,this.date.setSeconds(this.date.getSeconds()+a),this},addYear:function(a){return a=a||0,this.date.setYear(this.date.getFullYear()+a),this},setHours:function(){return this.date.setHours.apply(this.date,arguments),this},valueOf:function(){return this.date},getTime:function(){return this.date.valueOf()},toString:function(){return this.date.toString()},format:function(a){"string"!=typeof a&&(a="");for(var b in this._MAPS)a=this._MAPS[b].call(this,a,this.date,b);return a},diffMonth:function(a){var b=parseInt(this.format("Y")),d=parseInt(this.format("m")),e=new c.Date(a),f=parseInt(e.format("Y")),g=parseInt(e.format("m"));return 12*(f-b)+(g-d)},_DAY1:["周日","周一","周二","周三","周四","周五","周六"],_DAY2:["星期天","星期一","星期二","星期三","星期四","星期五","星期六"],_MAPS:{d:function(a,b,c){var d=b.getDate().toString();return d.length<2&&(d="0"+d),a.replace(new RegExp(c,"mg"),d)},j:function(a,b,c){return a.replace(new RegExp(c,"mg"),b.getDate())},N:function(a,b,c){var d=b.getDay();return 0===d&&(d=7),a.replace(new RegExp(c,"mg"),d)},w:function(a,b,c){var d=b.getDay(),e=this._DAY1[d];return a.replace(new RegExp(c,"mg"),e)},W:function(a,b,c){var d=b.getDay(),e=this._DAY2[d];return a.replace(new RegExp(c,"mg"),e)},m:function(a,b,c){var d=(b.getMonth()+1).toString();return d.length<2&&(d="0"+d),a.replace(new RegExp(c,"mg"),d)},n:function(a,b,c){return a.replace(c,b.getMonth()+1)},Y:function(a,b,c){return a.replace(new RegExp(c,"mg"),b.getFullYear())},y:function(a,b,c){return a.replace(new RegExp(c,"mg"),b.getYear())},g:function(a,b,c){var d=b.getHours();return d>=12&&(d-=12),a.replace(new RegExp(c,"mg"),d)},G:function(a,b,c){return a.replace(new RegExp(c,"mg"),b.getHours())},h:function(a,b,c){var d=b.getHours();return d>=12&&(d-=12),d+="",d.length<2&&(d="0"+d),a.replace(new RegExp(c,"mg"),d)},H:function(a,b,c){var d=b.getHours().toString();return d.length<2&&(d="0"+d),a.replace(new RegExp(c,"mg"),d)},i:function(a,b,c){var d=b.getMinutes().toString();return d.length<2&&(d="0"+d),a.replace(new RegExp(c,"mg"),d)},s:function(a,b,c){var d=b.getSeconds().toString();return d.length<2&&(d="0"+d),a.replace(new RegExp(c,"mg"),d)},I:function(a,b,c){var d=b.getMinutes().toString();return a.replace(new RegExp(c,"mg"),d)},S:function(a,b,c){var d=b.getSeconds().toString();return a.replace(new RegExp(c,"mg"),d)},D:function(a,c,d){var e=b.getServerDate();e.setHours(0,0,0,0),c=new Date(c.valueOf()),c.setHours(0,0,0,0);var f=864e5,g="",h=c-e;return h>=0&&(f>h?g="今天":2*f>h?g="明天":3*f>h&&(g="后天")),a.replace(new RegExp(d,"mg"),g)}}}),a.extend(c.Date,{parse:function(a,b){if("undefined"==typeof a)return new Date;if("string"==typeof a){a=a||"";var d=/^(\d{4})\-?(\d{1,2})\-?(\d{1,2})/i;a.match(d)&&(a=a.replace(d,"$2/$3/$1"));var e=Date.parse(a),f=new Date(e||new Date);return b?f:new c.Date(f)}return"number"==typeof a?new Date(a):new Date},getHM:function(a){var b=this._getDate(a),c=b.getHours(),d=b.getMinutes();return(10>c?"0"+c:""+c)+":"+(10>d?"0"+d:""+d)},getIntervalDay:function(a,b){var c=this._getDate(a),d=this._getDate(b);return c.setHours(0,0,0,0),d.setHours(0,0,0,0),parseInt((d-c)/864e5)},m2H:function(a){var b=Math.floor(a/60),c=a%60;return(b>0?b+"小时":"")+(c>0?c+"分钟":"")},_getDate:function(a){var b=c.Date.parse(a,!0),d=new Date;return d.setTime(b),d},format:function(a,b){return new c.Date(a).format(b)},weekday:function(a){var b=["周日","周一","周二","周三","周四","周五","周六"],c=new Date(a);return b[c.getDay()]},diffMonth:function(a,b){return a=new c.Date(a),a.diffMonth(b)}}),c.Date});