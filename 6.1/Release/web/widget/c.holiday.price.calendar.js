define(["cHolidayCalendar"],function(a){"use strict";var b=_.defaults({unit:"Â¥",lowestCls:"price_lowest",monthTemplate:'<section class="cui_cldunit"><h1 class="cui_cldmonth"><%= monthFormate %></h1><ul class="cui_cld_daybox"><% _.each(month, function(day) { %><li <% if (day.price) { %> data-price="<%= day.price %>" <% } %> data-date="<%= day.format %>" class="<% if (day.invalid) { print("cui_cld_invalid cui_cld_daypass"); } else { print("cui_cld_valid"); } if(day.desc) { print(" cui_cld_day_havetxt"); } if (day.cls) { print(" " + day.cls); } %>"><em><%= day.value %></em><% if (day.desc) { %><i><%= day.desc %></i><% } %><% }); %></ul></section>',priceDate:[],startPriceTime:!1},a.defaults),c=a.extend({initialize:function(a){this.options=$.extend(!0,{},b,a)},generateMonthModel:function(b,c){var d,e,f,g=a.getDaysInMonth(b,c),h=[],i=_.filter(this.options.priceDate,function(a){return a.date.getMonth()===c}),j=0,k=0,l=function(a){d=new Date(b,c,a),e={invalid:!0,value:m},_.extend(e,this.getDateDesc(d)),h.push(e)};i.length&&(j=i[0].date.getDate(),k=i[i.length-1].date.getDate());for(var m=1;j>m;m++)l.call(this,m);for(_.each(i,_.bind(function(b){d=b.date,e={invalid:!this.isPriceValidTime(d),price:b.price,format:a.dateFormat(d,"Y-m-d")},f=this.getDateDesc(d),e.value=f.desc||d.getDate(),e.cls=f.cls,b.price?e.desc=this.options.unit+b.price:e.cls=f.cls?"cui_cld_day_havetxt "+f.cls:"cui_cld_day_havetxt",h.push(e)},this)),m=k+1;g>=m;m++)l.call(this,m);return h},isPriceValidTime:function(a){var b=this.options.startPriceTime;return b?a.getTime()-b.getTime()>=0:!0},findMinPrice:function(){var a=this.$el.find(".cui_cld_daybox"),b=this.options.lowestCls;a.each(function(){var a,c=$(this).find("[data-price]"),d=[];c.each(function(){d.push(parseInt(this.getAttribute("data-price"),10))}),a=Math.min.apply(null,d),c.each(function(){var c=$(this),d=parseInt(c.attr("data-price"),10);d===a&&c.addClass(b)})})}});return c});