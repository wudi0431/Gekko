define(["cBase","cUIAbstractView"],function(a,b){var c={};return c.__propertys__=function(){this.itemTemplate=!1,this.triggerEl=null,this.click=function(){}},c.initialize=function($super,a){for(var b in a)this[b]=a[b];$super(a),this.bindEvent(),this.show(),this.hide()},c.showMenu=function(a){for(var b in a)this[b]=a[b];a.data&&this.init(),a.dir&&(this.el.removeClass("f-layer-before"),this.el.removeClass("f-layer-after"),this.el.addClass("up"==a.dir?"f-layer-before":"f-layer-after")),this.adjustEl(),this.show()},c.bindEvent=function(){this.addEvent("onHide",function(){this.root.off("click"),this.clsLayer&&document.removeEventListener("click",this.clsLayer,!0)}),this.addEvent("onShow",function(){this.init(),this.adjustEl(),this.setzIndexTop(),this.root.on("click",$.proxy(function(a){for(var b=$(a.target),c=!1;;){if(b.attr("id")==this.id)break;if("c"==b.attr("data-flag")){c=!0;break}b=b.parent()}c&&"function"==typeof this.click&&this.click.call(this,this.data[b.attr("data-index")])},this)),this.clsLayer=$.proxy(function(a){for(var b=$(a.target),c=!1;;){if(b.attr("id")==this.id){c=!0;break}if(!b[0])break;b=b.parent()}0==c&&this.hide()},this),document.addEventListener("click",this.clsLayer,!0)})},c.adjustEl=function(){if(this.triggerEl){var a=this.triggerEl.offset();this.el.css({width:"",transform:""});var b=6;this.el.css("up"==this.dir?{width:a.width-b,"-webkit-transform":"translate("+(a.left+2)+"px, "+(a.top+a.height+8)+"px) translateZ(0px)"}:{width:a.width-b,"-webkit-transform":"translate("+(a.left+2)+"px, "+(a.top-this.el.offset().height-8)+"px) translateZ(0px)"})}},c.init=function(){if(this.data){this.tmpt=_.template(['<ul class="cui-f-layer '+(this.dir?"up"==this.dir?"f-layer-before":"f-layer-after":"")+'" style="position: absolute; top: 0; left: 0; ">',"<% for(var i = 0, len = data.length; i < len; i++) { %>","<% var itemData = data[i]; %>",'<li data-index="<%=i%>" data-flag="c"  >'+(this.itemTemplate?this.itemTemplate:"<%=itemData.name %>")+"</li>","<% } %>","</ul>"].join(""));var a=this.tmpt({data:this.data});this.root.html(a),this.el=this.root.find(".cui-f-layer")}},c.createHtml=function(){return""},new a.Class(b,c)});