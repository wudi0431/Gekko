define(["libs","CommonStore","cLog"],function(a,b,c){var d=d||{};d.METHOD_ENTRY="METHOD_ENTRY",d.METHOD_MEMBER_LOGIN="METHOD_MEMBER_LOGIN",d.METHOD_NON_MEMBER_LOGIN="METHOD_NON_MEMBER_LOGIN",d.METHOD_AUTO_LOGIN="METHOD_AUTO_LOGIN",d.METHOD_LOCATE="METHOD_LOCATE",d.METHOD_REFRESH_NAV_BAR="METHOD_REFRESH_NAV_BAR",d.METHOD_CALL_PHONE="METHOD_CALL_PHONE",d.METHOD_BACK_TO_HOME="METHOD_BACK_TO_HOME",d.METHOD_BACK_TO_BOOK_CAR="METHOD_BACK_TO_BOOK_CAR",d.METHOD_BACK="METHOD_BACK",d.METHOD_COMMIT="METHOD_COMMIT",d.METHOD_CITY_CHOOSE="METHOD_CITY_CHOOSE",d.METHOD_REGISTER="METHOD_REGISTER",d.METHOD_LOG_EVENT="METHOD_LOG_EVENT",d.METHOD_INIT="METHOD_INIT",d.METHOD_CALL_SERVICE_CENTER="METHOD_CALL_SERVICE_CENTER",d.METHOD_BACK_TO_LAST_PAGE="METHOD_BACK_TO_LAST_PAGE",d.METHOD_GO_TO_BOOK_CAR_FINISHED_PAGE="METHOD_GO_TO_BOOK_CAR_FINISHED_PAGE",d.METHOD_GO_TO_HOTEL_DETAIL="METHOD_GO_TO_HOTEL_DETAIL",d.METHOD_OPEN_URL="METHOD_OPEN_URL",d.METHOD_CHECK_UPDATE="METHOD_CHECK_UPDATE",d.METHOD_RECOMMEND_APP_TO_FRIEND="METHOD_RECOMMEND_APP_TO_FRIEND",d.METHOD_ADD_WEIXIN_FRIEND="METHOD_ADD_WEIXIN_FRIEND",d.METHOD_SHOW_NEWEST_INTRODUCTION="METHOD_SHOW_NEWEST_INTRODUCTION",d.METHOD_BECOME_ACTIVE="METHOD_BECOME_ACTIVE",d.METHOD_WEB_VIEW_FINISHED_LOAD="METHOD_WEB_VIEW_FINISHED_LOAD",d.METHOD_CROSS_DOMAIN_HREF="METHOD_CROSS_DOMAIN_HREF",d.METHOD_CHECK_APP_INSTALL="METHOD_CHECK_APP_INSTALL",d.METHOD_CROSS_JUMP="METHOD_CROSS_JUMP",d.METHOD_REFRESH_NATIVE="METHOD_REFRESH_NATIVE",d.METHOD_H5_NEED_REFRESH="METHOD_H5_NEED_REFRESH",d.METHOD_READ_FROM_CLIPBOARD="METHOD_READ_FROM_CLIPBOARD",d.METHOD_COPY_TO_CLIPBOARD="METHOD_COPY_TO_CLIPBOARD",d.METHOD_SHARE_TO_VENDOR="METHOD_SHARE_TO_VENDOR",d.METHOD_DOWNLOAD_DATA="METHOD_DOWNLOAD_DATA",d.METHOD_NATIVE_LOG="METHOD_NATIVE_LOG",d.METHOD_SEND_H5_PIPE_REQUEST="METHOD_SEND_H5_PIPE_REQUEST",d.METHOD_SEND_HTTP_PIPE_REQUEST="METHOD_SEND_HTTP_PIPE_REQUEST",d.METHOD_CHECK_PAY_APP_INSTALL_STATUS="METHOD_CHECK_PAY_APP_INSTALL_STATUS",d.METHOD_OPEN_PAY_APP_BY_URL="METHOD_OPEN_PAY_APP_BY_URL",d.METHOD_SET_NAVBAR_HIDDEN="METHOD_SET_NAVBAR_HIDDEN",d.METHOD_SET_TOOLBAR_HIDDEN="METHOD_SET_TOOLBAR_HIDDEN",d.METHOD_CHECK_FILE_EXIST="METHOD_CHECK_FILE_EXIST",d.METHOD_DELETE_FILE="METHOD_DELETE_FILE",d.METHOD_GET_CURRENT_SANDBOX_NAME="METHOD_GET_CURRENT_SANDBOX_NAME",d.METHOD_GET_FILE_SIZE="METHOD_GET_FILE_SIZE",d.METHOD_MAKE_DIR="METHOD_MAKE_DIR",d.METHOD_READ_TEXT_FROM_FILE="METHOD_READ_TEXT_FROM_FILE",d.METHOD_WRITE_TEXT_TO_FILE="METHOD_WRITE_TEXT_TO_FILE",d.METHOD_ABORT_HTTP_PIPE_REQUEST="METHOD_ABORT_HTTP_PIPE_REQUEST",d.METHOD_OPEN_ADV_PAGE="METHOD_OPEN_ADV_PAGE",d.METHOD_WEB_VEW_DID_APPEAR="METHOD_WEB_VEW_DID_APPEAR",d.METHOD_SHOW_MAP="METHOD_SHOW_MAP",d.METHOD_ENCRYPT_BASE64="METHOD_ENCRYPT_BASE64",d.METHOD_ENCRYPT_CTRIP="METHOD_ENCRYPT_CTRIP",d.METHOD_APP_CHOOSE_INVOICE_TITLE="METHOD_APP_CHOOSE_INVOICE_TITLE";var e="h5_init_finished",f="member_login",g="non_member_login",h="member_auto_login",i="locate",j="back",k="commit",l="cityChoose",m="member_register",n="init_member_H5_info",o="become_active",p="web_view_finished_load",q="check_app_install_status",r="app_h5_need_refresh",s="read_copied_string_from_clipboard",t="download_data",u="send_h5_pipe_request",v="send_http_pipe_request",w="check_pay_app_install_status",x="check_file_exist",y="delete_file",z="get_current_sandbox_name",A="get_file_size",B="make_dir",C="read_text_from_file",D="write_text_to_file",E="web_view_did_appear",F="base64_encode",G="ctrip_encrypt",H="choose_invoice_title",I=!1,J={METHOD_NON_MEMBER_LOGIN:function(a){K[g]=function(d){c.applog("METHOD_NON_MEMBER_LOGIN",d),"string"==typeof d&&(d=JSON.parse(d));{var e=b.UserStore.getInstance();e.getUser()}e.setUser(d.data);var f=b.HeadStore.getInstance(),g=f.get();g.auth=d.data.Auth,f.set(g),"function"==typeof a.callback&&a.callback(d)}},METHOD_ENCRYPT_BASE64:function(a){K[F]=function(b){"string"==typeof b&&(b=JSON.parse(b)),"function"==typeof a.callback&&a.callback(b)}},METHOD_ENCRYPT_CTRIP:function(a){K[G]=function(b){"string"==typeof b&&(b=JSON.parse(b)),"function"==typeof a.callback&&a.callback(b)}},METHOD_LOCATE:function(a){K[i]=function(b){c.applog("METHOD_LOCATE",b);try{var d=b;"string"==typeof b&&(d=JSON.parse(b)),a.success(d)}catch(e){a.error(!0,"定位失败")}}},METHOD_MEMBER_LOGIN:function(a){K[f]=function(d){if(c.applog("METHOD_MEMBER_LOGIN",d),!d&&"function"==typeof a.callback)return a.callback();"string"==typeof d&&(d=JSON.parse(d));{var e=b.UserStore.getInstance();e.getUser()}e.setUser(d.data);var f=b.HeadStore.getInstance(),g=f.get();g.auth=d.data.Auth,f.set(g),"function"==typeof a.callback&&a.callback()}},METHOD_AUTO_LOGIN:function(a){K[h]=function(d){if(c.applog("METHOD_AUTO_LOGIN",d),"string"==typeof d&&(d=JSON.parse(d)),d){{var e=b.UserStore.getInstance();e.getUser()}e.setUser(d.data);var f=b.HeadStore.getInstance(),g=f.get();g.auth=d.data.Auth,f.set(g)}"function"==typeof a.callback&&a.callback(d)}},METHOD_REGISTER:function(a){K[m]=function(d){c.applog("METHOD_REGISTER",d),"string"==typeof d&&(d=JSON.parse(d));{var e=b.UserStore.getInstance();e.getUser()}e.setUser(d.data);var f=b.HeadStore.getInstance(),g=f.get();g.auth=d.data.Auth,f.set(g),"function"==typeof a.callback&&a.callback()}},METHOD_ENTRY:function(a){K[e]=a.callback},METHOD_BACK:function(a){K[j]=a.callback},METHOD_COMMIT:function(a){K[k]=a.callback},METHOD_CITY_CHOOSE:function(a){K[l]=a.callback},METHOD_SEND_H5_PIPE_REQUEST:function(a){K[u]=function(b){"function"==typeof a.callback&&a.callback(b)}},METHOD_SEND_HTTP_PIPE_REQUEST:function(a){K[v]=function(b){"function"==typeof a.callback&&a.callback(b)}},METHOD_CHECK_PAY_APP_INSTALL_STATUS:function(a){K[w]=function(b){"function"==typeof a.callback&&a.callback(b)}},METHOD_INIT:function(a){K[n]=function(d){if(c.applog("METHOD_INIT",d),"string"==typeof d&&(d=JSON.parse(d)),window.localStorage&&d){if(d&&d.userInfo)try{{var e=b.UserStore.getInstance();e.getUser()}e.setUser(d.userInfo.data);var f=b.HeadStore.getInstance(),g=f.get();g.auth=d.userInfo.data.Auth,f.set(g)}catch(h){alert("set data error")}if(d&&d.device){var i={device:d.device};window.localStorage.setItem("DEVICEINFO",JSON.stringify(i))}if(d&&d.appId){var j={version:d.version,appId:d.appId,serverVersion:d.serverVersion,platform:d.platform};window.localStorage.setItem("APPINFO",JSON.stringify(j))}d&&d.timestamp&&window.localStorage.setItem("SERVERDATE",d.timestamp),d&&d.sourceId&&window.localStorage.setItem("SOURCEID",d.sourceId),d&&d.isPreProduction&&window.localStorage.setItem("isPreProduction",d.isPreProduction)}a.callback()}},METHOD_WEB_VIEW_FINISHED_LOAD:function(a){K[p]=a.callback},METHOD_BECOME_ACTIVE:function(a){K[o]=a.callback},METHOD_CHECK_APP_INSTALL:function(a){K[q]=function(b){c.applog("METHOD_CHECK_APP_INSTALL",b),a.callback(b)}},METHOD_H5_NEED_REFRESH:function(a){K[r]=a.callback},METHOD_CHECK_FILE_EXIST:function(a){K[x]=function(b){a.callback(b)}},METHOD_DELETE_FILE:function(a){K[y]=function(b){a.callback(b)}},METHOD_GET_CURRENT_SANDBOX_NAME:function(a){K[z]=function(b){a.callback(b)}},METHOD_GET_FILE_SIZE:function(a){K[A]=function(b){a.callback(b)}},METHOD_MAKE_DIR:function(a){K[B]=function(b){a.callback(b)}},METHOD_READ_TEXT_FROM_FILE:function(a){K[C]=function(b){a.callback(b)}},METHOD_WRITE_TEXT_TO_FILE:function(a){K[D]=function(b){a.callback(b)}},METHOD_READ_FROM_CLIPBOARD:function(a){K[s]=function(b){c.applog("METHOD_READ_FROM_CLIPBOARD",b),a.callback(b)}},METHOD_DOWNLOAD_DATA:function(a){K[t]=function(b){c.applog("METHOD_DOWNLOAD_DATA",b),"function"==typeof a.callback&&a.callback(b)}},METHOD_WEB_VEW_DID_APPEAR:function(a){K[E]=function(b){a.callback(b)}},METHOD_APP_CHOOSE_INVOICE_TITLE:function(a){K[H]=function(b){"string"==typeof b&&(b=JSON.parse(b)),"function"==typeof a.callback&&a.callback(b)}}},K={},L={h5_init_finished:function(a){"function"==typeof K[e]&&K[e](a)},non_member_login:function(a){"function"==typeof K[g]&&K[g](a)},locate:function(a){"function"==typeof K[i]&&K[i](a)},member_login:function(a){"function"==typeof K[f]&&K[f](a)},back:function(){"function"==typeof K[j]&&K[j]()},commit:function(){"function"==typeof K[k]&&K[k]()},cityChoose:function(){"function"==typeof K[l]&&K[l]()},init_member_H5_info:function(a){"function"==typeof K[n]&&K[n](a)},member_register:function(){"function"==typeof K[m]&&K[m]()},web_view_finished_load:function(){"function"==typeof K[p]&&K[p]()},become_active:function(){"function"==typeof K[o]&&K[o]()},member_auto_login:function(a){"function"==typeof K[h]&&K[h](a)},check_app_install_status:function(a){"function"==typeof K[q]&&K[q](a)},app_h5_need_refresh:function(a){"function"==typeof K[r]&&K[r](a)},read_copied_string_from_clipboard:function(a){"function"==typeof K[s]&&K[s](a)},download_data:function(a){"function"==typeof K[t]&&K[t](a)},send_h5_pipe_request:function(a){"function"==typeof K[u]&&K[u](a)},send_http_pipe_request:function(a){"function"==typeof K[v]&&K[v](a)},check_pay_app_install_status:function(a){"function"==typeof K[w]&&K[w](a)},check_file_exist:function(a){"function"==typeof K[x]&&K[x](a)},delete_file:function(a){"function"==typeof K[y]&&K[y](a)},get_current_sandbox_name:function(a){"function"==typeof K[z]&&K[z](a)},get_file_size:function(a){"function"==typeof K[A]&&K[A](a)},make_dir:function(a){"function"==typeof K[B]&&K[B](a)},read_text_from_file:function(a){"function"==typeof K[C]&&K[C](a)},write_text_to_file:function(a){"function"==typeof K[D]&&K[D](a)},web_view_finished_load:function(a){"function"==typeof K[p]&&K[p](a)},web_view_did_appear:function(a){"function"==typeof K[E]&&K[E](a)},base64_encode:function(a){"function"==typeof K[F]&&K[F](a)},ctrip_encrypt:function(a){"function"==typeof K[G]&&K[G](a)},choose_invoice_title:function(a){"function"==typeof K[H]&&K[H](a)}},M={callback:function(a){if(!I){var b=a;if("string"==typeof a)try{b=JSON.parse(window.decodeURIComponent(a))}catch(c){setTimeout(function(){0},0)}return"function"==typeof L[b.tagname]?(L[b.tagname](b.param),!0):void 0}}},N=function(a){for(var b in M)a[b]=a[b]||M[b]};return d.init=function(){var a=window.app={};N(a)},d.register=function(a){"function"==typeof J[a.tagname]&&J[a.tagname](a)},d.unregister=function(a){d.register({tagname:a,callback:function(){}})},d.request=function(a){var b={METHOD_INIT:function(a){d.register({tagname:d.METHOD_INIT,callback:a.callback}),CtripUtil.app_init_member_H5_info()},METHOD_ENTRY:function(){},METHOD_MEMBER_LOGIN:function(a){d.register({tagname:d.METHOD_MEMBER_LOGIN,callback:a.callback}),CtripUser.app_member_login()},METHOD_NON_MEMBER_LOGIN:function(a){d.register({tagname:d.METHOD_NON_MEMBER_LOGIN,callback:a.callback}),CtripUser.app_non_member_login()},METHOD_AUTO_LOGIN:function(a){d.register({tagname:d.METHOD_AUTO_LOGIN,callback:a.callback}),CtripUser.app_member_auto_login()},METHOD_REGISTER:function(a){d.register({tagname:d.ETHOD_REGISTER,callback:a.callback}),CtripUser.app_member_register()},METHOD_LOCATE:function(a){d.register({tagname:d.METHOD_LOCATE,success:a.success,error:a.error});var b=!0;a.isAsync&&(b=a.isAsync),CtripMap.app_locate(b)},METHOD_REFRESH_NAV_BAR:function(a){CtripBar.app_refresh_nav_bar(a.config)},METHOD_CALL_PHONE:function(a){CtripUtil.app_call_phone(a.tel)},METHOD_BACK_TO_HOME:function(){CtripUtil.app_back_to_home()},METHOD_BACK_TO_BOOK_CAR:function(){app_back_to_book_car()},METHOD_LOG_EVENT:function(a){CtripUtil.app_log_event(a.event_name)},METHOD_CALL_SERVICE_CENTER:function(){CtripUtil.app_call_phone()},METHOD_BACK_TO_LAST_PAGE:function(a){var b=a.param||"";CtripUtil.app_back_to_last_page(b)},METHOD_GO_TO_BOOK_CAR_FINISHED_PAGE:function(a){CtripUtil.app_go_to_book_car_finished_page(a.url)},METHOD_GO_TO_HOTEL_DETAIL:function(a){CtripUtil.app_go_to_hotel_detail(a.hotelId,a.hotelName,a.cityId,a.isOverSea)},METHOD_OPEN_URL:function(a){var b=a.title||"",c=a.pageName||"";CtripUtil.app_open_url(a.openUrl,a.targetMode,b,c)},METHOD_CHECK_UPDATE:function(){CtripUtil.app_check_update()},METHOD_RECOMMEND_APP_TO_FRIEND:function(){CtripUtil.app_recommend_app_to_friends()},METHOD_ADD_WEIXIN_FRIEND:function(){CtripUtil.app_add_weixin_friend()},METHOD_CROSS_DOMAIN_HREF:function(a){CtripUtil.app_cross_domain_href(a.moduleType,a.anchor,a.param)},METHOD_SHOW_NEWEST_INTRODUCTION:function(){CtripUtil.app_show_newest_introduction()},METHOD_CHECK_APP_INSTALL:function(a){d.register({tagname:d.METHOD_CHECK_APP_INSTALL,callback:a.callback}),CtripUtil.app_check_app_install_status(a.url,a.package)},METHOD_CROSS_JUMP:function(a){CtripUtil.app_cross_package_href(a.path,a.param)},METHOD_REFRESH_NATIVE:function(a){CtripUtil.app_refresh_native_page(a.package,a.json)},METHOD_READ_FROM_CLIPBOARD:function(a){d.register({tagname:d.METHOD_READ_FROM_CLIPBOARD,callback:a.callback}),CtripUtil.app_read_copied_string_from_clipboard()},METHOD_COPY_TO_CLIPBOARD:function(a){CtripUtil.app_copy_string_to_clipboard(a.content)},METHOD_SHARE_TO_VENDOR:function(a){var b=a.title||"",c=a.linkUrl||"",d=a.isIOSSystemShare||!1;CtripUtil.app_call_system_share(a.imgUrl,a.text,b,c,d)},METHOD_DOWNLOAD_DATA:function(a){d.register({tagname:d.METHOD_DOWNLOAD_DATA,callback:a.callback}),CtripUtil.app_download_data(a.url,a.suffix)},METHOD_NATIVE_LOG:function(a){var b=window.localStorage.getItem("isPreProduction");b&&""!==b&&CtripTool.app_log("@[Wireless H5] "+a.log,a.result)},METHOD_SEND_H5_PIPE_REQUEST:function(a){d.register({tagname:d.METHOD_SEND_H5_PIPE_REQUEST,callback:a.callback}),CtripPipe.app_send_H5_pipe_request(a.serviceCode,a.header,a.data,a.sequenceId)},METHOD_SEND_HTTP_PIPE_REQUEST:function(a){d.register({tagname:d.METHOD_SEND_HTTP_PIPE_REQUEST,callback:a.callback}),CtripPipe.app_send_HTTP_pipe_request(a.target,a.methods,a.header,a.queryData,a.retryInfo,a.sequenceId)},METHOD_ABORT_HTTP_PIPE_REQUEST:function(a){CtripPipe.app_abort_HTTP_pipe_request(a.sequenceId)},METHOD_CHECK_PAY_APP_INSTALL_STATUS:function(a){d.register({tagname:d.METHOD_CHECK_PAY_APP_INSTALL_STATUS,callback:a.callback}),CtripPay.app_check_pay_app_install_status()},METHOD_OPEN_PAY_APP_BY_URL:function(a){CtripPay.app_open_pay_app_by_url(a.payAppName,a.payURL,a.successRelativeURL,a.detailRelativeURL)},METHOD_SET_NAVBAR_HIDDEN:function(a){CtripBar.app_set_navbar_hidden(a.isNeedHidden)},METHOD_SET_TOOLBAR_HIDDEN:function(a){CtripBar.app_set_toolbar_hidden(a.isNeedHidden)},METHOD_CHECK_FILE_EXIST:function(a){d.register({tagname:d.METHOD_CHECK_FILE_EXIST,callback:a.callback}),CtripFile.app_check_file_exist(a.fileName,a.relativeFilePath)},METHOD_DELETE_FILE:function(a){d.register({tagname:d.METHOD_DELETE_FILE,callback:a.callback}),CtripFile.app_delete_file(a.fileName,a.relativeFilePath)},METHOD_GET_CURRENT_SANDBOX_NAME:function(a){d.register({tagname:d.METHOD_GET_CURRENT_SANDBOX_NAME,callback:a.callback}),CtripFile.app_get_current_sandbox_name()},METHOD_GET_FILE_SIZE:function(a){d.register({tagname:d.METHOD_GET_FILE_SIZE,callback:callback}),CtripFile.app_get_file_size(a.fileName,a.relativeFilePath)},METHOD_MAKE_DIR:function(a){d.register({tagname:d.METHOD_MAKE_DIR,callback:callback}),CtripFile.app_make_dir(a.dirname,a.relativeFilePath)},METHOD_READ_TEXT_FROM_FILE:function(a){d.register({tagname:d.METHOD_READ_TEXT_FROM_FILE,callback:callback}),CtripFile.app_read_text_from_file(a.fileName,a.relativeFilePath)},METHOD_WRITE_TEXT_TO_FILE:function(a){d.register({tagname:d.METHOD_WRITE_TEXT_TO_FILE,callback:callback}),CtripFile.app_write_text_to_file(a.text,a.fileName,a.relativeFilePath,a.isAppend)},METHOD_OPEN_ADV_PAGE:function(a){CtripUtil.app_open_adv_page(a.url)},METHOD_SHOW_MAP:function(a){CtripMap.app_show_map(a.latitude,a.longitude,a.title,a.subtitle)},METHOD_ENCRYPT_BASE64:function(a){d.register({tagname:d.METHOD_ENCRYPT_BASE64,callback:a.callback}),CtripEncrypt.app_base64_encode(a.info)},METHOD_ENCRYPT_CTRIP:function(a){d.register({tagname:d.METHOD_ENCRYPT_CTRIP,callback:a.callback}),CtripEncrypt.app_ctrip_encrypt(a.inString,a.encType)},METHOD_APP_CHOOSE_INVOICE_TITLE:function(a){d.register({tagname:d.METHOD_APP_CHOOSE_INVOICE_TITLE,callback:a.callback}),CtripBusiness.app_choose_invoice_title(a.title)}};b[a.name](a)},d.getOpenUrl=function(a){var b="ctrip://wireless/"+a.module+"?";return _.each(a.param,function(a,c){b+=c+"="+a+"&"}),"&"===b[b.length-1]&&(b=b.slice(0,b.length-1)),b},d});